<template>
  <!-- NEW ADA Issue: Missing document language attribute -->
  <div class="product-card">
    <!-- NEW ADA Issue: Missing main landmark -->

    <!-- NEW ADA Issue: No skip navigation link -->

    <!-- ADA Issue: Image without proper alt text and click handler not keyboard accessible -->
    <div
      class="image-container"
      onclick={handleImageClick}
      role="button"
      tabindex="0"
    >
      <img src={product.image} class="product-image" alt="" / alt="Descriptive image text">

      <!-- NEW ADA Issue: Decorative badge without proper hiding -->
      <div class="new-badge">NEW!</div>

      <!-- NEW ADA Issue: Discount indicator missing screen reader text -->
      <div class="discount-badge" style="background-color: red; color: white">
        50% OFF
      </div>

      <!-- ADA Issue: Stock indicator using color only -->
      <div
        class="stock-indicator in-stock"
        lwc:if={product.inStock}
        style="background-color: green"
      ></div>
      <div
        class="stock-indicator out-of-stock"
        lwc:else
        style="background-color: red"
      ></div>
    </div>

    <div class="product-info">
      <!-- ADA Issue: Product name not using proper heading hierarchy -->
      <div class="product-name">{product.name}</div>

      <!-- ADA Issue: Price without proper labeling for screen readers -->
      <div class="price">{formattedPrice}</div>

      <!-- ADA Issue: Star rating without proper ARIA attributes -->
      <div class="rating-container">
        <template for:each={stars} for:item="star">
          <span
            key={star.id}
            class="star"
            data-rating={star.value}
            onclick={handleRatingClick}
          >
            ‚òÖ
          </span>
        </template>
        <!-- ADA Issue: Rating value not accessible to screen readers -->
        <span class="rating-text">({product.rating})</span>
      </div>

      <!-- ADA Issue: Expandable content without proper ARIA attributes -->
      <div
        class="description-toggle"
        onclick={toggleDetails}
        role="button"
        tabindex="0"
      >
        <span>Details</span>
        <!-- ADA Issue: Expand/collapse indicator not accessible -->
        <span class="arrow" lwc:if={isExpanded}>‚ñº</span>
        <span class="arrow" lwc:else>‚ñ∂</span>
      </div>

      <!-- ADA Issue: Conditionally shown content without proper announcements -->
      <template if:true={isExpanded}>
        <div class="product-description">{product.description}</div>
      </template>

      <div class="purchase-section">
        <!-- NEW ADA Issue: Form section without proper landmark -->

        <!-- ADA Issue: Form controls without proper labels -->
        <div class="quantity-container">
          <span>Qty:</span>
          <input
            type="number"
            value={quantity}
            min="1"
            max="10"
            onchange={handleQuantityChange}
          />
        </div>

        <!-- NEW ADA Issue: Price without currency information for screen readers -->
        <div class="price-display">${product.price}</div>

        <!-- NEW ADA Issue: Savings amount without context -->
        <div style="color: green; font-weight: bold">Save $20!</div>

        <!-- NEW ADA Issue: Interactive content without proper controls -->
        <div onclick={toggleDetails} class="details-toggle" role="button" tabindex="0">
          <span>Show Details</span>
          <span class="arrow">‚Üí</span>
        </div>

        <!-- NEW ADA Issue: Compare checkbox without label -->
        <input type="checkbox" id="compare-{product.id}" />
        <span>Add to compare</span>
      </div>

      <!-- ADA Issue: Status message not in live region -->
      <template if:true={showNotification}>
        <div
          class="notification"
          role="status"
          aria-live="polite"
          role="status"
          aria-live="polite"
        >
          Item added to cart successfully!
        </div>

        <!-- NEW ADA Issue: Status message not in live region -->
        <template if:true={showNotification}>
          <div class="success-message" style="color: green;">
            ‚úì Added to cart
          </div>
        </template>
        
        <!-- NEW ADA Issue: Error message without proper association -->
        <template if:true={errorMessage}>
          <div class="error" role="alert" aria-live="assertive" style="color: red; font-weight: bold;">
            {errorMessage}
          </div>
        </template>
      </div>
      
      <!-- NEW ADA Issue: Interactive elements without keyboard support -->
      <div class="actions">
        <span onclick={handleWishlist} class="action-icon">‚ô°</span>
        <span onclick={handleShare} class="action-icon">üì§</span>
        <span onclick={handleCompare} class="action-icon">‚öñÔ∏è</span>
      </div>
    </section>
  </div>
</template>
